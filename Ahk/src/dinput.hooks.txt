; <COMPILER: v1.1.15.03>
Global dinput := {}
dinput.CLSID_DirectInput := "{25E609E0-B259-11CF-BFC7-444553540000}"
dinput.CLSID_DirectInputDevice := "{25E609E1-B259-11CF-BFC7-444553540000}"
dinput.CLSID_DirectInput8 := "{25E609E4-B259-11CF-BFC7-444553540000}"
dinput.CLSID_DirectInputDevice8 := "{25E609E5-B259-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputA := "{89521360-AA8A-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputW := "{89521361-AA8A-11CF-BFC7-444553540000}"
dinput.IID_IDirectInput2A := "{5944E662-AA8A-11CF-BFC7-444553540000}"
dinput.IID_IDirectInput2W := "{5944E663-AA8A-11CF-BFC7-444553540000}"
dinput.IID_IDirectInput7A := "{9A4CB684-236D-11D3-8E9D-00C04F6844AE}"
dinput.IID_IDirectInput7W := "{9A4CB685-236D-11D3-8E9D-00C04F6844AE}"
dinput.IID_IDirectInput8A := "{BF798030-483A-4DA2-AA99-5D64ED369700}"
dinput.IID_IDirectInput8W := "{BF798031-483A-4DA2-AA99-5D64ED369700}"
dinput.IID_IDirectInputDeviceA := "{5944E680-C92E-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputDeviceW := "{5944E681-C92E-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputDevice2A := "{5944E682-C92E-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputDevice2W := "{5944E683-C92E-11CF-BFC7-444553540000}"
dinput.IID_IDirectInputDevice7A := "{57D7C6BC-2356-11D3-8E9D-00C04F6844AE}"
dinput.IID_IDirectInputDevice7W := "{57D7C6BD-2356-11D3-8E9D-00C04F6844AE}"
dinput.IID_IDirectInputDevice8A := "{54D41080-DC15-4833-A41B-748F73A38179}"
dinput.IID_IDirectInputDevice8W := "{54D41081-DC15-4833-A41B-748F73A38179}"
dinput.IID_IDirectInputEffect := "{E7E1F7C0-88D2-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_XAxis := "{A36D02E0-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_YAxis := "{A36D02E1-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_ZAxis := "{A36D02E2-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_RxAxis := "{A36D02F4-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_RyAxis := "{A36D02F5-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_RzAxis := "{A36D02E3-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_Slider := "{A36D02E4-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_Button := "{A36D02F0-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_Key := "{55728220-D33C-11CF-BFC7-444553540000}"
dinput.GUID_POV := "{A36D02F2-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_Unknown := "{A36D02F3-C9F3-11CF-BFC7-444553540000}"
dinput.GUID_SysMouse := "{6F1D2B60-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_SysKeyboard := "{6F1D2B61-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_Joystick := "{6F1D2B70-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_SysMouseEm := "{6F1D2B80-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_SysMouseEm2 := "{6F1D2B81-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_SysKeyboardEm := "{6F1D2B82-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_SysKeyboardEm2 := "{6F1D2B83-D5A0-11CF-BFC7-444553540000}"
dinput.GUID_ConstantForce := "{13541C20-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_RampForce := "{13541C21-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Square := "{13541C22-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Sine := "{13541C23-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Triangle := "{13541C24-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_SawtoothUp := "{13541C25-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_SawtoothDown := "{13541C26-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Spring := "{13541C27-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Damper := "{13541C28-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Inertia := "{13541C29-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_Friction := "{13541C2A-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.GUID_CustomForce := "{13541C2B-8E33-11D0-9AD0-00A0C9A06E35}"
dinput.IDirectInputEffect := {}
dinput.IDirectInputEffect.name := "IDirectInputEffect"
dinput.IDirectInputEffect.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(GetEffectGuid)(THIS_ LPGUID) PURE;
    STDMETHOD(GetParameters)(THIS_ LPDIEFFECT,DWORD) PURE;
    STDMETHOD(SetParameters)(THIS_ LPCDIEFFECT,DWORD) PURE;
    STDMETHOD(Start)(THIS_ DWORD,DWORD) PURE;
    STDMETHOD(Stop)(THIS) PURE;
    STDMETHOD(GetEffectStatus)(THIS_ LPDWORD) PURE;
    STDMETHOD(Download)(THIS) PURE;
    STDMETHOD(Unload)(THIS) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
"
)
dinput.IDirectInputDeviceW := {}
dinput.IDirectInputDeviceW.name := "IDirectInputDeviceW"
dinput.IDirectInputDeviceW.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEW,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEW) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
"
)
dinput.IDirectInputDeviceA := {}
dinput.IDirectInputDeviceA.name := "IDirectInputDeviceA"
dinput.IDirectInputDeviceA.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEA,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEA) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
"
)
dinput.IDirectInputDevice2W := {}
dinput.IDirectInputDevice2W.name := "IDirectInputDevice2W"
dinput.IDirectInputDevice2W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEW,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEW) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOW,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
"
)
dinput.IDirectInputDevice2A := {}
dinput.IDirectInputDevice2A.name := "IDirectInputDevice2A"
dinput.IDirectInputDevice2A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEA,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEA) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOA,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
"
)
dinput.IDirectInputDevice7W := {}
dinput.IDirectInputDevice7W.name := "IDirectInputDevice7W"
dinput.IDirectInputDevice7W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEW,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEW) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOW,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(EnumEffectsInFile)(THIS_ LPCWSTR,LPDIENUMEFFECTSINFILECALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(WriteEffectToFile)(THIS_ LPCWSTR,DWORD,LPDIFILEEFFECT,DWORD) PURE;
"
)
dinput.IDirectInputDevice7A := {}
dinput.IDirectInputDevice7A.name := "IDirectInputDevice7A"
dinput.IDirectInputDevice7A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEA,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEA) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOA,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(EnumEffectsInFile)(THIS_ LPCSTR,LPDIENUMEFFECTSINFILECALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(WriteEffectToFile)(THIS_ LPCSTR,DWORD,LPDIFILEEFFECT,DWORD) PURE;
"
)
dinput.IDirectInputDevice8W := {}
dinput.IDirectInputDevice8W.name := "IDirectInputDevice8W"
dinput.IDirectInputDevice8W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEW,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEW) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOW,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(EnumEffectsInFile)(THIS_ LPCWSTR,LPDIENUMEFFECTSINFILECALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(WriteEffectToFile)(THIS_ LPCWSTR,DWORD,LPDIFILEEFFECT,DWORD) PURE;
    STDMETHOD(BuildActionMap)(THIS_ LPDIACTIONFORMATW,LPCWSTR,DWORD) PURE;
    STDMETHOD(SetActionMap)(THIS_ LPDIACTIONFORMATW,LPCWSTR,DWORD) PURE;
    STDMETHOD(GetImageInfo)(THIS_ LPDIDEVICEIMAGEINFOHEADERW) PURE;
"
)
dinput.IDirectInputDevice8A := {}
dinput.IDirectInputDevice8A.name := "IDirectInputDevice8A"
dinput.IDirectInputDevice8A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(GetCapabilities)(THIS_ LPDIDEVCAPS) PURE;
    STDMETHOD(EnumObjects)(THIS_ LPDIENUMDEVICEOBJECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetProperty)(THIS_ REFGUID,LPDIPROPHEADER) PURE;
    STDMETHOD(SetProperty)(THIS_ REFGUID,LPCDIPROPHEADER) PURE;
    STDMETHOD(Acquire)(THIS) PURE;
    STDMETHOD(Unacquire)(THIS) PURE;
    STDMETHOD(GetDeviceState)(THIS_ DWORD,LPVOID) PURE;
    STDMETHOD(GetDeviceData)(THIS_ DWORD,LPDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(SetDataFormat)(THIS_ LPCDIDATAFORMAT) PURE;
    STDMETHOD(SetEventNotification)(THIS_ HANDLE) PURE;
    STDMETHOD(SetCooperativeLevel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(GetObjectInfo)(THIS_ LPDIDEVICEOBJECTINSTANCEA,DWORD,DWORD) PURE;
    STDMETHOD(GetDeviceInfo)(THIS_ LPDIDEVICEINSTANCEA) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD,REFGUID) PURE;
    STDMETHOD(CreateEffect)(THIS_ REFGUID,LPCDIEFFECT,LPDIRECTINPUTEFFECT *,LPUNKNOWN) PURE;
    STDMETHOD(EnumEffects)(THIS_ LPDIENUMEFFECTSCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetEffectInfo)(THIS_ LPDIEFFECTINFOA,REFGUID) PURE;
    STDMETHOD(GetForceFeedbackState)(THIS_ LPDWORD) PURE;
    STDMETHOD(SendForceFeedbackCommand)(THIS_ DWORD) PURE;
    STDMETHOD(EnumCreatedEffectObjects)(THIS_ LPDIENUMCREATEDEFFECTOBJECTSCALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(Escape)(THIS_ LPDIEFFESCAPE) PURE;
    STDMETHOD(Poll)(THIS) PURE;
    STDMETHOD(SendDeviceData)(THIS_ DWORD,LPCDIDEVICEOBJECTDATA,LPDWORD,DWORD) PURE;
    STDMETHOD(EnumEffectsInFile)(THIS_ LPCSTR,LPDIENUMEFFECTSINFILECALLBACK,LPVOID,DWORD) PURE;
    STDMETHOD(WriteEffectToFile)(THIS_ LPCSTR,DWORD,LPDIFILEEFFECT,DWORD) PURE;
    STDMETHOD(BuildActionMap)(THIS_ LPDIACTIONFORMATA,LPCSTR,DWORD) PURE;
    STDMETHOD(SetActionMap)(THIS_ LPDIACTIONFORMATA,LPCSTR,DWORD) PURE;
    STDMETHOD(GetImageInfo)(THIS_ LPDIDEVICEIMAGEINFOHEADERA) PURE;
"
)
dinput.IDirectInputW := {}
dinput.IDirectInputW.name := "IDirectInputW"
dinput.IDirectInputW.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEW *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
"
)
dinput.IDirectInputA := {}
dinput.IDirectInputA.name := "IDirectInputA"
dinput.IDirectInputA.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEA *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
"
)
dinput.IDirectInput2W := {}
dinput.IDirectInput2W.name := "IDirectInput2W"
dinput.IDirectInput2W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEW *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCWSTR,LPGUID) PURE;
"
)
dinput.IDirectInput2A := {}
dinput.IDirectInput2A.name := "IDirectInput2A"
dinput.IDirectInput2A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEA *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCSTR,LPGUID) PURE;
"
)
dinput.IDirectInput7W := {}
dinput.IDirectInput7W.name := "IDirectInput7W"
dinput.IDirectInput7W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEW *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCWSTR,LPGUID) PURE;
    STDMETHOD(CreateDeviceEx)(THIS_ REFGUID,REFIID,LPVOID *,LPUNKNOWN) PURE;
"
)
dinput.IDirectInput7A := {}
dinput.IDirectInput7A.name := "IDirectInput7A"
dinput.IDirectInput7A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICEA *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCSTR,LPGUID) PURE;
    STDMETHOD(CreateDeviceEx)(THIS_ REFGUID,REFIID,LPVOID *,LPUNKNOWN) PURE;
"
)
dinput.IDirectInput8W := {}
dinput.IDirectInput8W.name := "IDirectInput8W"
dinput.IDirectInput8W.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICE8W *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKW,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCWSTR,LPGUID) PURE;
    STDMETHOD(EnumDevicesBySemantics)(THIS_ LPCWSTR,LPDIACTIONFORMATW,LPDIENUMDEVICESBYSEMANTICSCBW,LPVOID,DWORD) PURE;
    STDMETHOD(cfgureDevices)(THIS_ LPDIcfgUREDEVICESCALLBACK,LPDIcfgUREDEVICESPARAMSW,DWORD,LPVOID) PURE;
"
)
dinput.IDirectInput8A := {}
dinput.IDirectInput8A.name := "IDirectInput8A"
dinput.IDirectInput8A.def :=
( 
"
    STDMETHOD(QueryInterface)(THIS_ REFIID riid, LPVOID * ppvObj) PURE;
    STDMETHOD_(ULONG,AddRef)(THIS) PURE;
    STDMETHOD_(ULONG,Release)(THIS) PURE;
    STDMETHOD(CreateDevice)(THIS_ REFGUID,LPDIRECTINPUTDEVICE8A *,LPUNKNOWN) PURE;
    STDMETHOD(EnumDevices)(THIS_ DWORD,LPDIENUMDEVICESCALLBACKA,LPVOID,DWORD) PURE;
    STDMETHOD(GetDeviceStatus)(THIS_ REFGUID) PURE;
    STDMETHOD(RunControlPanel)(THIS_ HWND,DWORD) PURE;
    STDMETHOD(Initialize)(THIS_ HINSTANCE,DWORD) PURE;
    STDMETHOD(FindDevice)(THIS_ REFGUID,LPCSTR,LPGUID) PURE;
    STDMETHOD(EnumDevicesBySemantics)(THIS_ LPCSTR,LPDIACTIONFORMATA,LPDIENUMDEVICESBYSEMANTICSCBA,LPVOID,DWORD) PURE;
    STDMETHOD(cfgureDevices)(THIS_ LPDIcfgUREDEVICESCALLBACK,LPDIcfgUREDEVICESPARAMSA,DWORD,LPVOID) PURE;
"
)
Global DI8DEVCLASS_DEVICE := 1
Global DI8DEVCLASS_GAMECTRL := 4
Global DI8DEVCLASS_KEYBOARD := 3
Global DI8DEVCLASS_POINTER := 2
Global DI8DEVTYPE1STPERSON_SHOOTER := 4
Global DI8DEVTYPE1STPERSON_SIXDOF := 3
Global DI8DEVTYPE1STPERSON_UNKNOWN := 2
Global DI8DEVTYPE_1STPERSON := 24
Global DI8DEVTYPE_DEVICE := 17
Global DI8DEVTYPE_DEVICECTRL := 25
Global DI8DEVTYPE_DRIVING := 22
Global DI8DEVTYPE_FLIGHT := 23
Global DI8DEVTYPE_GAMEPAD := 21
Global DI8DEVTYPE_JOYSTICK := 20
Global DI8DEVTYPE_KEYBOARD := 19
Global DI8DEVTYPE_LIMITEDGAMESUBTYPE := 1
Global DI8DEVTYPE_MOUSE := 18
Global DI8DEVTYPE_REMOTE := 27
Global DI8DEVTYPE_SCREENPOINTER := 26
Global DI8DEVTYPE_SUPPLEMENTAL := 28
Global DI8DEVTYPEDEVICECTRL_COMMSSELECTION := 3
Global DI8DEVTYPEDEVICECTRL_COMMSSELECTION_HARDWIRED := 4
Global DI8DEVTYPEDEVICECTRL_UNKNOWN := 2
Global DI8DEVTYPEDRIVING_COMBINEDPEDALS := 2
Global DI8DEVTYPEDRIVING_DUALPEDALS := 3
Global DI8DEVTYPEDRIVING_HANDHELD := 5
Global DI8DEVTYPEDRIVING_THREEPEDALS := 4
Global DI8DEVTYPEFLIGHT_RC := 4
Global DI8DEVTYPEFLIGHT_STICK := 2
Global DI8DEVTYPEFLIGHT_YOKE := 3
Global DI8DEVTYPEGAMEPAD_STANDARD := 2
Global DI8DEVTYPEGAMEPAD_TILT := 3
Global DI8DEVTYPEJOYSTICK_STANDARD := 2
Global DI8DEVTYPEKEYBOARD_J3100 := 12
Global DI8DEVTYPEKEYBOARD_JAPAN106 := 10
Global DI8DEVTYPEKEYBOARD_JAPANAX := 11
Global DI8DEVTYPEKEYBOARD_NEC98 := 7
Global DI8DEVTYPEKEYBOARD_NEC98106 := 9
Global DI8DEVTYPEKEYBOARD_NEC98LAPTOP := 8
Global DI8DEVTYPEKEYBOARD_NOKIA1050 := 5
Global DI8DEVTYPEKEYBOARD_NOKIA9140 := 6
Global DI8DEVTYPEKEYBOARD_OLIVETTI := 2
Global DI8DEVTYPEKEYBOARD_PCAT := 3
Global DI8DEVTYPEKEYBOARD_PCENH := 4
Global DI8DEVTYPEKEYBOARD_PCXT := 1
Global DI8DEVTYPEMOUSE_ABSOLUTE := 6
Global DI8DEVTYPEMOUSE_FINGERSTICK := 3
Global DI8DEVTYPEMOUSE_TOUCHPAD := 4
Global DI8DEVTYPEMOUSE_TRACKBALL := 5
Global DI8DEVTYPEMOUSE_TRADITIONAL := 2
Global DI8DEVTYPEMOUSE_UNKNOWN := 1
Global DI8DEVTYPEREMOTE_UNKNOWN := 2
Global DI8DEVTYPESCREENPTR_LIGHTGUN := 3
Global DI8DEVTYPESCREENPTR_LIGHTPEN := 4
Global DI8DEVTYPESCREENPTR_TOUCH := 5
Global DI8DEVTYPESCREENPTR_UNKNOWN := 2
Global DI8DEVTYPESUPPLEMENTAL_2NDHANDCONTROLLER := 3
Global DI8DEVTYPESUPPLEMENTAL_COMBINEDPEDALS := 10
Global DI8DEVTYPESUPPLEMENTAL_DUALPEDALS := 11
Global DI8DEVTYPESUPPLEMENTAL_HANDTRACKER := 5
Global DI8DEVTYPESUPPLEMENTAL_HEADTRACKER := 4
Global DI8DEVTYPESUPPLEMENTAL_RUDDERPEDALS := 13
Global DI8DEVTYPESUPPLEMENTAL_SHIFTER := 7
Global DI8DEVTYPESUPPLEMENTAL_SHIFTSTICKGATE := 6
Global DI8DEVTYPESUPPLEMENTAL_SPLITTHROTTLE := 9
Global DI8DEVTYPESUPPLEMENTAL_THREEPEDALS := 12
Global DI8DEVTYPESUPPLEMENTAL_THROTTLE := 8
Global DI8DEVTYPESUPPLEMENTAL_UNKNOWN := 2
Global DI_DEGREES := 100
Global DI_DOWNLOADSKIPPED := 0x00000003
Global DI_EFFECTRESTARTED := 0x00000004
Global DI_FFNOMINALMAX := 10000
Global DI_POLLEDDEVICE := 0x00000002
Global DI_SECONDS := 1000000
Global DI_SETTINGSNOTSAVED := 0x0000000B
Global DI_TRUNCATED := 0x00000008
Global DI_TRUNCATEDANDRESTARTED := 0x0000000C
Global DI_WRITEPROTECT := 0x00000013
Global DIA_APPFIXED := 16
Global DIA_APPMAPPED := 2
Global DIA_APPNOMAP := 4
Global DIA_FORCEFEEDBACK := 1
Global DIA_NORANGE := 8
Global DIAFTS_NEWDEVICEHIGH := 4294967295
Global DIAFTS_NEWDEVICELOW := 4294967295
Global DIAH_APPREQUESTED := 2
Global DIAH_DEFAULT := 32
Global DIAH_ERROR := 2147483648
Global DIAH_HWAPP := 4
Global DIAH_HWDEFAULT := 8
Global DIAH_USERcfg := 1
Global DIAXIS_ANY_1 := 4278206977
Global DIAXIS_ANY_2 := 4278206978
Global DIAXIS_ANY_3 := 4278206979
Global DIAXIS_ANY_4 := 4278206980
Global DIAXIS_ANY_A_1 := 4278436353
Global DIAXIS_ANY_A_2 := 4278436354
Global DIAXIS_ANY_B_1 := 4278469121
Global DIAXIS_ANY_B_2 := 4278469122
Global DIAXIS_ANY_C_1 := 4278501889
Global DIAXIS_ANY_C_2 := 4278501890
Global DIAXIS_ANY_R_1 := 4278338049
Global DIAXIS_ANY_R_2 := 4278338050
Global DIAXIS_ANY_S_1 := 4278534657
Global DIAXIS_ANY_S_2 := 4278534658
Global DIAXIS_ANY_U_1 := 4278370817
Global DIAXIS_ANY_U_2 := 4278370818
Global DIAXIS_ANY_V_1 := 4278403585
Global DIAXIS_ANY_V_2 := 4278403586
Global DIAXIS_ANY_X_1 := 4278239745
Global DIAXIS_ANY_X_2 := 4278239746
Global DIAXIS_ANY_Y_1 := 4278272513
Global DIAXIS_ANY_Y_2 := 4278272514
Global DIAXIS_ANY_Z_1 := 4278305281
Global DIAXIS_ANY_Z_2 := 4278305282
Global DICD_EDIT := 1
Global DIDAL_BOTTOMALIGNED := 8
Global DIDAL_LEFTALIGNED := 1
Global DIDAL_RIGHTALIGNED := 2
Global DIDAL_TOPALIGNED := 4
Global DIDBAM_HWDEFAULTS := 4
Global DIDBAM_INITIALIZE := 2
Global DIDBAM_PRESERVE := 1
Global DIDC_ALIAS := 65536
Global DIDC_ATTACHED := 1
Global DIDC_DEADBAND := 16384
Global DIDC_EMULATED := 4
Global DIDC_FFATTACK := 512
Global DIDC_FFFADE := 1024
Global DIDC_FORCEFEEDBACK := 256
Global DIDC_HIDDEN := 262144
Global DIDC_PHANTOM := 131072
Global DIDC_POLLEDDATAFORMAT := 8
Global DIDC_POLLEDDEVICE := 2
Global DIDC_POSNEGCOEFFICIENTS := 4096
Global DIDC_POSNEGSATURATION := 8192
Global DIDC_SATURATION := 2048
Global DIDC_STARTDELAY := 32768
Global DIDEVTYPE_DEVICE := 1
Global DIDEVTYPE_HID := 65536
Global DIDEVTYPE_JOYSTICK := 4
Global DIDEVTYPE_KEYBOARD := 3
Global DIDEVTYPE_MOUSE := 2
Global DIDEVTYPEJOYSTICK_FLIGHTSTICK := 3
Global DIDEVTYPEJOYSTICK_GAMEPAD := 4
Global DIDEVTYPEJOYSTICK_HEADTRACKER := 7
Global DIDEVTYPEJOYSTICK_RUDDER := 5
Global DIDEVTYPEJOYSTICK_TRADITIONAL := 2
Global DIDEVTYPEJOYSTICK_UNKNOWN := 1
Global DIDEVTYPEJOYSTICK_WHEEL := 6
Global DIDEVTYPEKEYBOARD_J3100 := 12
Global DIDEVTYPEKEYBOARD_JAPAN106 := 10
Global DIDEVTYPEKEYBOARD_JAPANAX := 11
Global DIDEVTYPEKEYBOARD_NEC98 := 7
Global DIDEVTYPEKEYBOARD_NEC98106 := 9
Global DIDEVTYPEKEYBOARD_NEC98LAPTOP := 8
Global DIDEVTYPEKEYBOARD_NOKIA1050 := 5
Global DIDEVTYPEKEYBOARD_NOKIA9140 := 6
Global DIDEVTYPEKEYBOARD_OLIVETTI := 2
Global DIDEVTYPEKEYBOARD_PCAT := 3
Global DIDEVTYPEKEYBOARD_PCENH := 4
Global DIDEVTYPEKEYBOARD_PCXT := 1
Global DIDEVTYPEMOUSE_FINGERSTICK := 3
Global DIDEVTYPEMOUSE_TOUCHPAD := 4
Global DIDEVTYPEMOUSE_TRACKBALL := 5
Global DIDEVTYPEMOUSE_TRADITIONAL := 2
Global DIDEVTYPEMOUSE_UNKNOWN := 1
Global DIDF_ABSAXIS := 1
Global DIDF_RELAXIS := 2
Global DIDFT_ABSAXIS := 2
Global DIDFT_ALIAS := 134217728
Global DIDFT_ANYINSTANCE := 16776960
Global DIDFT_AXIS := 3
Global DIDFT_BUTTON := 12
Global DIDFT_COLLECTION := 64
Global DIDFT_FFACTUATOR := 16777216
Global DIDFT_FFEFFECTTRIGGER := 33554432
Global DIDFT_NOCOLLECTION := 16776960
Global DIDFT_NODATA := 128
Global DIDFT_OPTIONAL := 2147483648
Global DIDFT_OUTPUT := 268435456
Global DIDFT_POV := 16
Global DIDFT_PSHBUTTON := 4
Global DIDFT_RELAXIS := 1
Global DIDFT_TGLBUTTON := 8
Global DIDFT_VENDORDEFINED := 67108864
Global DIDIFT_cfgURATION := 1
Global DIDIFT_OVERLAY := 2
Global DIDOI_ASPECTACCEL := 768
Global DIDOI_ASPECTFORCE := 1024
Global DIDOI_ASPECTMASK := 3840
Global DIDOI_ASPECTPOSITION := 256
Global DIDOI_ASPECTVELOCITY := 512
Global DIDOI_FFACTUATOR := 1
Global DIDOI_FFEFFECTTRIGGER := 2
Global DIDOI_GUIDISUSAGE := 65536
Global DIDOI_POLLED := 32768
Global DIDSAM_FORCESAVE := 2
Global DIDSAM_NOUSER := 1
Global DIEB_NOTRIGGER := 4294967295
Global DIEDBS_MAPPEDPRI1 := 1
Global DIEDBS_MAPPEDPRI2 := 2
Global DIEDBS_NEWDEVICE := 32
Global DIEDBS_RECENTDEVICE := 16
Global DIEDBSFL_AVAILABLEDEVICES := 4096
Global DIEDBSFL_MULTIMICEKEYBOARDS := 8192
Global DIEDBSFL_NONGAMINGDEVICES := 16384
Global DIEDBSFL_THISUSER := 16
Global DIEDBSFL_VALID := 28944
Global DIEDFL_ATTACHEDONLY := 1
Global DIEDFL_FORCEFEEDBACK := 256
Global DIEDFL_INCLUDEALIASES := 65536
Global DIEDFL_INCLUDEHIDDEN := 262144
Global DIEDFL_INCLUDEPHANTOMS := 131072
Global DIEFF_CARTESIAN := 16
Global DIEFF_OBJECTIDS := 1
Global DIEFF_OBJECTOFFSETS := 2
Global DIEFF_POLAR := 32
Global DIEFF_SPHERICAL := 64
Global DIEFT_CONDITION := 4
Global DIEFT_CONSTANTFORCE := 1
Global DIEFT_CUSTOMFORCE := 5
Global DIEFT_DEADBAND := 16384
Global DIEFT_FFATTACK := 512
Global DIEFT_FFFADE := 1024
Global DIEFT_HARDWARE := 255
Global DIEFT_PERIODIC := 3
Global DIEFT_POSNEGCOEFFICIENTS := 4096
Global DIEFT_POSNEGSATURATION := 8192
Global DIEFT_RAMPFORCE := 2
Global DIEFT_SATURATION := 2048
Global DIEFT_STARTDELAY := 32768
Global DIEGES_EMULATED := 2
Global DIEGES_PLAYING := 1
Global DIENUM_CONTINUE := 1
Global DIEP_ALLPARAMS := 511
Global DIEP_ALLPARAMS_DX5 := 511
Global DIEP_AXES := 32
Global DIEP_DIRECTION := 64
Global DIEP_DURATION := 1
Global DIEP_ENVELOPE := 128
Global DIEP_GAIN := 4
Global DIEP_NODOWNLOAD := 2147483648
Global DIEP_NORESTART := 1073741824
Global DIEP_SAMPLEPERIOD := 2
Global DIEP_START := 536870912
Global DIEP_STARTDELAY := 512
Global DIEP_TRIGGERBUTTON := 8
Global DIEP_TRIGGERREPEATINTERVAL := 16
Global DIEP_TYPESPECIFICPARAMS := 256
Global DIERR_DEVICEFULL := 0x80040201
Global DIERR_EFFECTPLAYING := 0x80040208
Global DIERR_HASEFFECTS := 0x80040204
Global DIERR_INCOMPLETEEFFECT := 0x80040206
Global DIERR_INSUFFICIENTPRIVS := 0x80040200
Global DIERR_MAPFILEFAIL := 0x8004020B
Global DIERR_MOREDATA := 0x80040202
Global DIERR_NOTBUFFERED := 0x80040207
Global DIERR_NOTDOWNLOADED := 0x80040203
Global DIERR_NOTEXCLUSIVEACQUIRED := 0x80040205
Global DIERR_REPORTFULL := 0x8004020A
Global DIERR_UNPLUGGED := 0x80040209
Global DIES_NODOWNLOAD := 2147483648
Global DIES_SOLO := 1
Global DIFEF_INCLUDENONSTANDARD := 1
Global DIFEF_MODIFYIFNEEDED := 16
Global DIGDD_PEEK := 1
Global DIGFFS_ACTUATORSOFF := 32
Global DIGFFS_ACTUATORSON := 16
Global DIGFFS_DEVICELOST := 2147483648
Global DIGFFS_EMPTY := 1
Global DIGFFS_PAUSED := 4
Global DIGFFS_POWEROFF := 128
Global DIGFFS_POWERON := 64
Global DIGFFS_SAFETYSWITCHOFF := 512
Global DIGFFS_SAFETYSWITCHON := 256
Global DIGFFS_STOPPED := 2
Global DIGFFS_USERFFSWITCHOFF := 2048
Global DIGFFS_USERFFSWITCHON := 1024
Global DIK_0 := 11
Global DIK_1 := 2
Global DIK_2 := 3
Global DIK_3 := 4
Global DIK_4 := 5
Global DIK_5 := 6
Global DIK_6 := 7
Global DIK_7 := 8
Global DIK_8 := 9
Global DIK_9 := 10
Global DIK_A := 30
Global DIK_APOSTROPHE := 40
Global DIK_B := 48
Global DIK_BACKSLASH := 43
Global DIK_C := 46
Global DIK_CAPITAL := 58
Global DIK_COMMA := 51
Global DIK_D := 32
Global DIK_E := 18
Global DIK_EQUALS := 13
Global DIK_ESCAPE := 1
Global DIK_F := 33
Global DIK_F1 := 59
Global DIK_F10 := 68
Global DIK_F11 := 87
Global DIK_F12 := 88
Global DIK_F2 := 60
Global DIK_F3 := 61
Global DIK_F4 := 62
Global DIK_F5 := 63
Global DIK_F6 := 64
Global DIK_F7 := 65
Global DIK_F8 := 66
Global DIK_F9 := 67
Global DIK_G := 34
Global DIK_H := 35
Global DIK_I := 23
Global DIK_J := 36
Global DIK_K := 37
Global DIK_L := 38
Global DIK_LBRACKET := 26
Global DIK_LCONTROL := 29
Global DIK_LSHIFT := 42
Global DIK_M := 50
Global DIK_N := 49
Global DIK_NUMLOCK := 69
Global DIK_NUMPAD0 := 82
Global DIK_NUMPAD1 := 79
Global DIK_NUMPAD2 := 80
Global DIK_NUMPAD3 := 81
Global DIK_NUMPAD4 := 75
Global DIK_NUMPAD5 := 76
Global DIK_NUMPAD6 := 77
Global DIK_NUMPAD7 := 71
Global DIK_NUMPAD8 := 72
Global DIK_NUMPAD9 := 73
Global DIK_O := 24
Global DIK_P := 25
Global DIK_Q := 16
Global DIK_R := 19
Global DIK_RBRACKET := 27
Global DIK_RCONTROL := 157
Global DIK_RSHIFT := 54
Global DIK_S := 31
Global DIK_SEMICOLON := 39
Global DIK_SPACE := 57
Global DIK_SYSRQ := 183
Global DIK_T := 20
Global DIK_TAB := 15
Global DIK_U := 22
Global DIK_V := 47
Global DIK_W := 17
Global DIK_X := 45
Global DIK_Y := 21
Global DIK_Z := 44
Global DIKEYBOARD_0 := 2164261899
Global DIKEYBOARD_1 := 2164261890
Global DIKEYBOARD_2 := 2164261891
Global DIKEYBOARD_3 := 2164261892
Global DIKEYBOARD_4 := 2164261893
Global DIKEYBOARD_5 := 2164261894
Global DIKEYBOARD_6 := 2164261895
Global DIKEYBOARD_7 := 2164261896
Global DIKEYBOARD_8 := 2164261897
Global DIKEYBOARD_9 := 2164261898
Global DIKEYBOARD_A := 2164261918
Global DIKEYBOARD_APOSTROPHE := 2164261928
Global DIKEYBOARD_B := 2164261936
Global DIKEYBOARD_BACKSLASH := 2164261931
Global DIKEYBOARD_C := 2164261934
Global DIKEYBOARD_CAPITAL := 2164261946
Global DIKEYBOARD_COMMA := 2164261939
Global DIKEYBOARD_D := 2164261920
Global DIKEYBOARD_E := 2164261906
Global DIKEYBOARD_EQUALS := 2164261901
Global DIKEYBOARD_ESCAPE := 2164261889
Global DIKEYBOARD_F := 2164261921
Global DIKEYBOARD_F1 := 2164261947
Global DIKEYBOARD_F10 := 2164261956
Global DIKEYBOARD_F11 := 2164261975
Global DIKEYBOARD_F12 := 2164261976
Global DIKEYBOARD_F2 := 2164261948
Global DIKEYBOARD_F3 := 2164261949
Global DIKEYBOARD_F4 := 2164261950
Global DIKEYBOARD_F5 := 2164261951
Global DIKEYBOARD_F6 := 2164261952
Global DIKEYBOARD_F7 := 2164261953
Global DIKEYBOARD_F8 := 2164261954
Global DIKEYBOARD_F9 := 2164261955
Global DIKEYBOARD_G := 2164261922
Global DIKEYBOARD_H := 2164261923
Global DIKEYBOARD_I := 2164261911
Global DIKEYBOARD_J := 2164261924
Global DIKEYBOARD_K := 2164261925
Global DIKEYBOARD_L := 2164261926
Global DIKEYBOARD_LBRACKET := 2164261914
Global DIKEYBOARD_LCONTROL := 2164261917
Global DIKEYBOARD_LSHIFT := 2164261930
Global DIKEYBOARD_M := 2164261938
Global DIKEYBOARD_N := 2164261937
Global DIKEYBOARD_NUMLOCK := 2164261957
Global DIKEYBOARD_NUMPAD0 := 2164261970
Global DIKEYBOARD_NUMPAD1 := 2164261967
Global DIKEYBOARD_NUMPAD2 := 2164261968
Global DIKEYBOARD_NUMPAD3 := 2164261969
Global DIKEYBOARD_NUMPAD4 := 2164261963
Global DIKEYBOARD_NUMPAD5 := 2164261964
Global DIKEYBOARD_NUMPAD6 := 2164261965
Global DIKEYBOARD_NUMPAD7 := 2164261959
Global DIKEYBOARD_NUMPAD8 := 2164261960
Global DIKEYBOARD_NUMPAD9 := 2164261961
Global DIKEYBOARD_O := 2164261912
Global DIKEYBOARD_P := 2164261913
Global DIKEYBOARD_Q := 2164261904
Global DIKEYBOARD_R := 2164261907
Global DIKEYBOARD_RBRACKET := 2164261915
Global DIKEYBOARD_RCONTROL := 2164262045
Global DIKEYBOARD_RSHIFT := 2164261942
Global DIKEYBOARD_S := 2164261919
Global DIKEYBOARD_SEMICOLON := 2164261927
Global DIKEYBOARD_SPACE := 2164261945
Global DIKEYBOARD_SYSRQ := 2164262071
Global DIKEYBOARD_T := 2164261908
Global DIKEYBOARD_TAB := 2164261903
Global DIKEYBOARD_U := 2164261910
Global DIKEYBOARD_V := 2164261935
Global DIKEYBOARD_W := 2164261905
Global DIKEYBOARD_X := 2164261933
Global DIKEYBOARD_Y := 2164261909
Global DIKEYBOARD_Z := 2164261932
Global DIPH_BYID := 2
Global DIPH_BYOFFSET := 1
Global DIPH_BYUSAGE := 3
Global DIPOV_ANY_1 := 4278208001
Global DIPOV_ANY_2 := 4278208002
Global DIPOV_ANY_3 := 4278208003
Global DIPOV_ANY_4 := 4278208004
Global DIPROPAUTOCENTER_ON := 1
Global DIPROPAXISMODE_REL := 1
Global DIPROPCALIBRATIONMODE_RAW := 1
Global DIRECTINPUT_HEADER_VERSION := 2048
Global DISCL_BACKGROUND := 8
Global DISCL_EXCLUSIVE := 1
Global DISCL_FOREGROUND := 4
Global DISCL_NONEXCLUSIVE := 2
Global DISCL_NOWINKEY := 16
Global DISDD_CONTINUE := 1
Global DISFFC_CONTINUE := 8
Global DISFFC_PAUSE := 4
Global DISFFC_RESET := 1
Global DISFFC_SETACTUATORSOFF := 32
Global DISFFC_SETACTUATORSON := 16
Global DISFFC_STOPALL := 2
Global DIVIRTUAL_ARCADE_PLATFORM := 570425344
Global DIVIRTUAL_ARCADE_SIDE2SIDE := 553648128
Global DIVIRTUAL_BROWSER_CONTROL := 671088640
Global DIVIRTUAL_CAD_2DCONTROL := 587202560
Global DIVIRTUAL_CAD_3DCONTROL := 603979776
Global DIVIRTUAL_CAD_FLYBY := 620756992
Global DIVIRTUAL_CAD_MODEL := 637534208
Global DIVIRTUAL_DRIVING_COMBAT := 33554432
Global DIVIRTUAL_DRIVING_MECHA := 687865856
Global DIVIRTUAL_DRIVING_RACE := 16777216
Global DIVIRTUAL_DRIVING_TANK := 50331648
Global DIVIRTUAL_FIGHTING_FPS := 150994944
Global DIVIRTUAL_FIGHTING_HAND2HAND := 134217728
Global DIVIRTUAL_FIGHTING_THIRDPERSON := 167772160
Global DIVIRTUAL_FLYING_CIVILIAN := 67108864
Global DIVIRTUAL_FLYING_HELICOPTER := 100663296
Global DIVIRTUAL_FLYING_MILITARY := 83886080
Global DIVIRTUAL_REMOTE_CONTROL := 654311424
Global DIVIRTUAL_SPACESIM := 117440512
Global DIVIRTUAL_SPORTS_BASEBALL_BAT := 251658240
Global DIVIRTUAL_SPORTS_BASEBALL_FIELD := 285212672
Global DIVIRTUAL_SPORTS_BASEBALL_PITCH := 268435456
Global DIVIRTUAL_SPORTS_BASKETBALL_DEFENSE := 318767104
Global DIVIRTUAL_SPORTS_BASKETBALL_OFFENSE := 301989888
Global DIVIRTUAL_SPORTS_BIKING_MOUNTAIN := 469762048
Global DIVIRTUAL_SPORTS_FISHING := 234881024
Global DIVIRTUAL_SPORTS_FOOTBALL_DEFENSE := 385875968
Global DIVIRTUAL_SPORTS_FOOTBALL_FIELD := 335544320
Global DIVIRTUAL_SPORTS_FOOTBALL_OFFENSE := 369098752
Global DIVIRTUAL_SPORTS_FOOTBALL_QBCK := 352321536
Global DIVIRTUAL_SPORTS_GOLF := 402653184
Global DIVIRTUAL_SPORTS_HOCKEY_DEFENSE := 436207616
Global DIVIRTUAL_SPORTS_HOCKEY_GOALIE := 452984832
Global DIVIRTUAL_SPORTS_HOCKEY_OFFENSE := 419430400
Global DIVIRTUAL_SPORTS_HUNTING := 218103808
Global DIVIRTUAL_SPORTS_RACQUET := 536870912
Global DIVIRTUAL_SPORTS_SKIING := 486539264
Global DIVIRTUAL_SPORTS_SOCCER_DEFENSE := 520093696
Global DIVIRTUAL_SPORTS_SOCCER_OFFENSE := 503316480
Global DIVIRTUAL_STRATEGY_ROLEPLAYING := 184549376
Global DIVIRTUAL_STRATEGY_TURN := 201326592
Global DIVOICE_ALL := 2197816330
Global DIVOICE_CHANNEL1 := 2197816321
Global DIVOICE_CHANNEL2 := 2197816322
Global DIVOICE_CHANNEL3 := 2197816323
Global DIVOICE_CHANNEL4 := 2197816324
Global DIVOICE_CHANNEL5 := 2197816325
Global DIVOICE_CHANNEL6 := 2197816326
Global DIVOICE_CHANNEL7 := 2197816327
Global DIVOICE_CHANNEL8 := 2197816328
Global DIVOICE_PLAYBACKMUTE := 2197816332
Global DIVOICE_RECORDMUTE := 2197816331
Global DIVOICE_TEAM := 2197816329
Global DIVOICE_TRANSMIT := 2197816333
Global DIVOICE_VOICECOMMAND := 2197816336
Global E_PENDING := 0x8000000A
Global JOY_HWS_AUTOLOAD := 0x10000000
Global JOY_HWS_GAMEPORTBUSBUSY := 0x00000001
Global JOY_HWS_ISANALOGPORTDRIVER := 0x08000000
Global JOY_HWS_ISGAMEPORTBUS := 0x80000000
Global JOY_HWS_ISGAMEPORTDRIVER := 0x04000000
Global JOY_HWS_ISHEADTRACKER := 0x02000000
Global JOY_HWS_NODEVNODE := 0x20000000
Global JOY_OEMPOLL_PASSDRIVERDATA := 7
Global JOY_PASSDRIVERDATA := 0x10000000
Global JOY_US_VOLATILE := 0x00000008
Global MAXCPOINTSNUM := 8
dinput.err := {}
dinput.err["" . 0] := "DI_OK"
dinput.err[2147942487 . ""] := "DIERR_INVALIDPARAMS"
global DIDEVICEINSTANCE_DX3A := Struct("DWORD dwSize, GUID guidInstance, GUID guidProduct, DWORD dwDevType,"
. "CHAR tszInstanceName[260], CHAR tszProductName[260]")
global DIDEVCAPS_DX3 :=
(
"
    DWORD   dwSize;
    DWORD   dwFlags;
    DWORD   dwDevType;
    DWORD   dwAxes;
    DWORD   dwButtons;
    DWORD   dwPOVs;
"
)
DIDEVCAPS_DX3 := Struct(DIDEVCAPS_DX3)
global DIDEVCAPS :=
(
"
    DWORD dwSize; 
    DWORD dwFlags; 
    DWORD dwDevType; 
    DWORD dwAxes; 
    DWORD dwButtons; 
    DWORD dwPOVs; 
    DWORD dwFFSamplePeriod; 
    DWORD dwFFMinTimeResolution; 
    DWORD dwFirmwareRevision; 
    DWORD dwHardwareRevision; 
    DWORD dwDriverVersion;
"
)
DIDEVCAPS := Struct(DIDEVCAPS)
global DIJOYSTATE :=
(
"
	LONG lX;
    LONG lY;
    LONG lZ;
    LONG lRx;
    LONG lRy;
    LONG lRz;
    LONG rglSlider[2];
    DWORD rgdwPOV[4];
    BYTE rgbButtons[32];
"
)
DIJOYSTATE := Struct(DIJOYSTATE)
global DIJOYSTATE_DX3 :=
(
"	
	LONG lX;
    LONG lY;
    LONG lZ;
    LONG lRx;
    LONG lRy;
    LONG lRz;
    Byte rgdwPOV[4];
    Byte rgbButtons[32];
"
)
DIJOYSTATE_DX3 := Struct(DIJOYSTATE_DX3)
global DIJOYSTATE2 :=
(
"
    LONG    lX;
    LONG    lY;
    LONG    lZ;
    LONG    lRx;
    LONG    lRy;
    LONG    lRz;
    LONG    rglSlider[2];
    DWORD   rgdwPOV[4];
    BYTE    rgbButtons[128];
    LONG    lVX;
    LONG    lVY;
    LONG    lVZ;
    LONG    lVRx;
    LONG    lVRy;
    LONG    lVRz;
    LONG    rglVSlider[2];
    LONG    lAX;
    LONG    lAY;
    LONG    lAZ;
    LONG    lARx;
    LONG    lARy;
    LONG    lARz;
    LONG    rglASlider[2];
    LONG    lFX;
    LONG    lFY;
    LONG    lFZ;
    LONG    lFRx;
    LONG    lFRy;
    LONG    lFRz;
    LONG    rglFSlider[2];
"
)
DIJOYSTATE2 := Struct(DIJOYSTATE2)
global DIEffectInfo :=
(
"
    DWORD dwSize;
    GUID guid;
    DWORD dwEffType;
    DWORD dwStaticParams;
    DWORD dwDynamicParams;
    TCHAR tszName[MAX_PATH];
"
)
DIEffectInfo := struct(DIEffectInfo)
global IDirectInputA :=0, IDirectInputW :=0, IDirectInputDeviceA :=0, IDirectInputDeviceW :=0, IDirectInputDevice2W:=0,IDirectInputDevice2A:=0
global IDirectInput8W:=0, IDirectInput8A:=0, IDirectInputDevice8W:=0, IDirectInputDevice8A:=0
global IDirectInput7W:=0, IDirectInput7A:=0, IDirectInputDevice7A:=0, IDirectInputDevice7W:=0
global g_XinputDevicesDinputGUIDS := []
GetDirectInput7(w = false)
{
p := dllcall("GetProcAddress", ptr, dllcall("LoadLibrary", str, "dinput.dll", ptr), astr, "DirectInputCreateEx")
if (!p)
return "GetProcAddress or LoadLibrary failed"
GUID_FromString(iid, w ? dinput.IID_IDirectInput7W : dinput.IID_IDirectInput7W)
r := dllcall(p, uint, A_ModuleHandle, uint, 0x0700, ptr, &iid, "uint*", pDI:=0, uint, 0, uint)
if (r)
return "DirectInputCreateEx Failed"
if not (w)
{
IDirectInput7A := new ComInterfaceWrapper(dinput.IDirectInput7A, pDI, True)
GUID_FromString(GUID, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInput7A.CreateDevice, uint, IDirectInput7A.p, uint, &GUID, "uint*", pDvc:=0, uint, 0, uint)
if (r != 0)
return "Failed to create the IDirectInputDevice7A interface " r " - " dinput.err[r . ""] ErrorLevel " " pDI
IDirectInputDevice7A := new ComInterfaceWrapper(dinput.IDirectInputDevice7A, pDvc, True)
}
else
{
IDirectInput7W  := new ComInterfaceWrapper(dinput.IDirectInput7W, pDI, True)
GUID_FromString(GUID, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInput7W.CreateDevice, uint, IDirectInput7W.p, uint, &GUID, "uint*", pDvc:=0, uint, 0, uint)
if (r != 0)
return "Failed to create the IDirectInputDevice7W interface " r " - " dinput.err[r . ""]
IDirectInputDevice7W := new ComInterfaceWrapper(dinput.IDirectInputDevice7W, pDvc, True)
}
return "Succeeded to create the DirectInput7 Interfaces"
}
DirectInputCreate(w = False)
{
p := dllcall("GetProcAddress", ptr, dllcall("LoadLibrary", str, "dinput.dll", ptr), astr, w ? "DirectInputCreateW" : "DirectInputCreateA")
if (!p)
return "GetProcAddress or LoadLibrary failed"
r := dllcall(p, uint, A_ModuleHandle, uint, 0x0500, "uint*", pDI:=0, uint, 0, uint)
if (r)
return "DirectInputCreate Failed"
if (w)
IDirectInputW  := new ComInterfaceWrapper(dinput.IDirectInputW, pDI, True)
else IDirectInputA := new ComInterfaceWrapper(dinput.IDirectInputA, pDI, True)
}
GetDirectInput(w = false)
{
r := DirectInputCreate(w)
if (r)
return "Failed to create the IDirectInput interface " r " - " dinput.err[r . ""]
if (!w)
{
g_XinputDevicesDinputGUIDS := []
print("Enumerating Controlers:`n")
r := dllcall(IDirectInputA.EnumDevices, uint, IDirectInputA.p, uint, DIDEVTYPE_JOYSTICK
, uint, RegisterCallback("DIEnumDevicesCallback")
, uint, 0, uint, DIEDFL_ATTACHEDONLY, uint)
GUID_FromString(iid, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInputA.CreateDevice, uint, IDirectInputA.p, uint, &iid, "uint*", pDvc:=0, uint, 0, uint)
if (r != 0)
return "Failed to create the IDirectInputDevice interface " r " - " dinput.err[r . ""]
IDirectInputDeviceA := new ComInterfaceWrapper(dinput.IDirectInputDeviceA, pDvc, True)
GUID_FromString(iid, dinput.IID_IDirectInputDevice2A)
r := dllcall(IDirectInputDeviceA.QueryInterface, uint, IDirectInputDeviceA.p, uint, &iid, "uint*", pDvc:=0)
if (r != 0)
return "Failed to create the IDirectInputDevice2 interface " r " - " dinput.err[r . ""]
IDirectInputDevice2A := new ComInterfaceWrapper(dinput.IDirectInputDevice2A, pDvc, True)
}
else
{
GUID_FromString(iid, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInputW.CreateDevice, uint, IDirectInputW.p, uint, &iid, "uint*", pDvc:=0, uint, 0, uint)
if (r != 0)
return "Failed to create the IDirectInputDevice interface " r " - " dinput.err[r . ""]
IDirectInputDeviceW := new ComInterfaceWrapper(dinput.IDirectInputDeviceW, pDvc, True)
GUID_FromString(iid, dinput.IID_IDirectInputDevice2W)
r := dllcall(IDirectInputDeviceW.QueryInterface, uint, IDirectInputDeviceW.p, uint, &iid, "uint*", pDvc:=0)
if (r != 0)
return "Failed to create the IDirectInputDevice2 interface " r " - " dinput.err[r . ""]
IDirectInputDevice2W := new ComInterfaceWrapper(dinput.IDirectInputDevice2W, pDvc, True)
}
return "Succeeded to create the DirectInput Interfaces"
}
DIEnumDevicesCallback(lpddi, pvRef)
{
hpx      := dllcall("GetModuleHandle", str, "peixoto.dll", uint)
IsXinput := dllcall("GetProcAddress", uint, hpx, astr, "IsXInputDevice", uint)
DIDEVICEINSTANCE_DX3A[] := lpddi
add_ := DIDEVICEINSTANCE_DX3A[] + DIDEVICEINSTANCE_DX3A.offset("tszInstanceName")
if (pvRef = 0)
name  := strget(add_+0, "CP0")
else name := strget(add_+0, "UTF-16")
guidProduct := DIDEVICEINSTANCE_DX3A[] + DIDEVICEINSTANCE_DX3A.offset("guidProduct")
guidInstace := DIDEVICEINSTANCE_DX3A[] + DIDEVICEINSTANCE_DX3A.offset("guidInstance")
xinput      := dllcall(IsXinput, uint, guidProduct, int) ? "Yes" : "No"
guid_string := StringFromIID(guidInstace)
if (xinput)
g_XinputDevicesDinputGUIDS.insert([name, guid_string])
printl("Controler: " name " " guid_string " Xinput: " xinput)
printl(guid_string)
return True
}
GetDirectInput8(w=True)
{
dllcall("LoadLibraryW", str, "dinput8.dll")
GUID_FromString(dinputGUID, w ? dinput.IID_IDirectInput8W : dinput.IID_IDirectInput8A)
r := dllcall("dinput8.dll\DirectInput8Create", uint, A_ModuleHandle, uint, 0x0800, uint, &dinputGUID, "uint*", pDI:=0, uint, 0, uint)
if (r)
return "Failed to create the IDirectInput8 interface" r " " dinput.err[r . ""]
if (w)
{
IDirectInput8W := new ComInterfaceWrapper(dinput.IDirectInput8W,  pDI, True)
GUID_FromString(GUID, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInput8W.CreateDevice, uint, IDirectInput8W.p, uint, &GUID, "uint*", pDvc:=0, uint, 0, uint)
if (r)
return "Failed to create the IDirectInputDevice8 interface" r " " dinput.err[r . ""]
IDirectInputDevice8W :=  new ComInterfaceWrapper(dinput.IDirectInputDevice8W, pDvc, True)
return "Succeeded to create the DirectInput8 Interfaces"
} else {
IDirectInput8A := new ComInterfaceWrapper(dinput.IDirectInput8A,  pDI, True)
GUID_FromString(GUID, dinput.GUID_SysKeyboard)
r := dllcall(IDirectInput8A.CreateDevice, uint, IDirectInput8A.p, uint, &GUID, "uint*", pDvc:=0, uint, 0, uint)
if (r)
return "Failed to create the IDirectInputDevice8 interface" r " " dinput.err[r . ""]
IDirectInputDevice8A :=  new ComInterfaceWrapper(dinput.IDirectInputDevice8A, pDvc, True)
return "Succeeded to create the DirectInput8 Interfaces"
}
}
global DINPT_HOOKS :=
(
"
int           DZone;
int         NgDZone;
DWORD          Flag;
DWORD      Buts[12];
DWORD      Trigs[2];
LPVOID        GtStt;
LPVOID       GtStt8;
LPVOID       GtSttW;
LPVOID      GtStt8W;
LPVOID        StPrp;
LPVOID       StPrp8;
LPVOID       StPrpW;
LPVOID      StPrp8W;
LPVOID        CrtFx;
LPVOID       CrtFx8;
LPVOID       CrtFxW;
LPVOID      CrtFx8W;
LPVOID        GtCps;
LPVOID       GtCps8;
LPVOID       GtCpsW;
LPVOID      GtCps8W;
LPVOID    EnumObjcs;
LPVOID   EnumObjcs8;
LPVOID   EnumObjcsW;
LPVOID  EnumObjcs8W;
LPVOID   SetDataFmt;
LPVOID  SetDataFmt8;
LPVOID  SetDataFmtW;
LPVOID SetDataFmt8W;
LPVOID      GetData;
LPVOID     GetData8;
LPVOID     GetDataW;
LPVOID    GetData8W;
"
)
DINPT_HOOKS := struct(DINPT_HOOKS)
global g_dnpt := {}
g_dnpt.controls := ["A","B","X","Y"
, "LEFT_THUMB", "RIGHT_THUMB", "LEFT_SHOULDER", "RIGHT_SHOULDER"
, "start", "back", "bRightTrigger", "bLeftTrigger"]
g_dnpt.pDIGetRange := dllcall("GetProcAddress", uint, g_.h_PeixotoDll, astr, "DIGetRange")
g_dnpt.loger       := new Loger(g_.cfg.injector_dir "\Input.log")
InitDInputEmu(byref cfg, _unicode = true)
{
if (r:=XinPutGetState(1))
{
logerr("NO xinput gamepad " r)
return
}
cfg       := parsecfg(cfg)
cfg.layer := True
dllcall("peixoto.dll\InitDInputHooks", ptr, DINPT_HOOKS[])
if (cfg.layer)
dllcall("peixoto.dll\InitDInputLayer")
g_dnpt.loger.log(GetDirectInput(0))
g_dnpt.loger.log(GetDirectInput(1))
g_dnpt.loger.log(GetDirectInput7(0))
g_dnpt.loger.log(GetDirectInput7(1))
g_dnpt.loger.log(GetDirectInput8(0))
g_dnpt.loger.log(GetDirectInput8(1))
g_dnpt.loger.log(IDirectInputA.compare([IDirectInputW, IDirectInput7A, IDirectInput7W]))
g_dnpt.loger.log(IDirectInputDeviceA.compare([IDirectInputDeviceW, IDirectInputDevice7A, IDirectInputDevice7W]))
g_dnpt.loger.log(IDirectInput8A.compare([IDirectInput8W]))
g_dnpt.loger.log(IDirectInputDevice8A.compare([IDirectInputDevice8W]))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("GetDeviceState", "DinputDevice8GetState"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("GetDeviceState", "DinputDeviceGetState"))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("SetProperty", "DinputDevice8SetProperty"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("SetProperty", "DinputDeviceSetProperty"))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("GetCapabilities", "Di8GetDvcCaps"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("GetCapabilities", "DiGetDvcCaps"))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("EnumObjects", "DiEnumObjects8Hook"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("EnumObjects", "DiEnumObjectsHook"))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("SetDataFormat", "DiDcvSetDataFormat"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("SetDataFormat", "DiDcvSetDataFormat"))
g_dnpt.loger.log(IDirectInputDevice8A.dllhook("GetDeviceData", "DinputDeviceGetData"))
g_dnpt.loger.log(IDirectInputDeviceA.dllhook("GetDeviceData", "DinputDeviceGetData"))
DINPT_HOOKS.GtCps        := IDirectInputDeviceA.GetCapabilities
DINPT_HOOKS.GtCps8       := IDirectInputDevice8A.GetCapabilities
DINPT_HOOKS.GtStt        := IDirectInputDeviceA.GetDeviceState
DINPT_HOOKS.GtStt8       := IDirectInputDevice8A.GetDeviceState
DINPT_HOOKS.StPrp        := IDirectInputDeviceA.SetProperty
DINPT_HOOKS.StPrp8       := IDirectInputDevice8A.SetProperty
DINPT_HOOKS.EnumObjcs    := IDirectInputDeviceA.EnumObjects
DINPT_HOOKS.EnumObjcs8   := IDirectInputDevice8A.EnumObjects
DINPT_HOOKS.GetData      := IDirectInputDeviceA.GetDeviceData
DINPT_HOOKS.GetData8     := IDirectInputDevice8A.GetDeviceData
if (cfg.layer)
{
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("GetDeviceState", "DinputDevice8GetStateW"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("GetDeviceState", "DinputDeviceGetStateW"))
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("SetProperty", "DinputDevice8SetPropertyW"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("SetProperty", "DinputDeviceSetPropertyW"))
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("GetCapabilities", "Di8GetDvcCapsW"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("GetCapabilities", "DiGetDvcCapsW"))
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("EnumObjects", "DiEnumObjects8WHook"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("EnumObjects", "DiEnumObjectsWHook"))
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("SetDataFormat", "DiDcvSetDataFormat"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("SetDataFormat", "DiDcvSetDataFormat"))
g_dnpt.loger.log(IDirectInputDevice8W.dllhook("GetDeviceData", "DinputDeviceGetData"))
g_dnpt.loger.log(IDirectInputDeviceW.dllhook("GetDeviceData", "DinputDeviceGetData"))
DINPT_HOOKS.GtCpsW       := IDirectInputDeviceW.GetCapabilities
DINPT_HOOKS.GtCps8W      := IDirectInputDevice8W.GetCapabilities
DINPT_HOOKS.GtSttW       := IDirectInputDeviceW.GetDeviceState
DINPT_HOOKS.GtStt8W      := IDirectInputDevice8W.GetDeviceState
DINPT_HOOKS.StPrpW       := IDirectInputDeviceW.SetProperty
DINPT_HOOKS.StPrp8W      := IDirectInputDevice8W.SetProperty
DINPT_HOOKS.EnumObjcsW   := IDirectInputDeviceW.EnumObjects
DINPT_HOOKS.EnumObjcs8W  := IDirectInputDevice8W.EnumObjects
DINPT_HOOKS.SetDataFmtW  := IDirectInputDeviceW.SetDataFormat
DINPT_HOOKS.SetDataFmt8W := IDirectInputDevice8W.SetDataFormat
DINPT_HOOKS.GetDataW     := IDirectInputDeviceW.GetDeviceData
DINPT_HOOKS.GetData8W    := IDirectInputDevice8W.GetDeviceData
}
mds              := strsplit(cfg.mds, ",")
ls_mode          := mds[17]
dp_mode          := mds[1] & 0xF
DINPT_HOOKS.flag := ls_mode | (dp_mode << 4)
if cfg.rs
DINPT_HOOKS.flag |= (cfg.rs << 8)
g_dnpt.loger.log("flags " DINPT_HOOKS.flag)
buts             := strsplit(cfg.a, ",")
for k, v in strsplit(cfg.mds, ",")
{
if (k<5)
continue
else if (k>16)
break
if (v=3)
{
DINPT_HOOKS.buts[k-4]     := strsplit(buts[k], "Gamepad ")[2]
} else DINPT_HOOKS.buts[k-4]  := 0
g_dnpt.loger.log("Button " k " " DINPT_HOOKS.buts[k-4])
}
(cfg.dz = 0) ?: cfg.dz := 0.25
g_dnpt.dead    := cfg.dz * 32768
g_dnpt.dead_m  := g_dnpt.dead*(-1)
DINPT_HOOKS.DZone   := g_dnpt.dead
DINPT_HOOKS.NgDZone := g_dnpt.dead_m
if (cfg.ff)
{
g_dnpt.loger.log(IDirectInput8W.Hook("EnumDevices", "IDirectInput8W_EnumDevices") )
g_dnpt.loger.log(IDirectInput8A.Hook("EnumDevices", "IDirectInput8A_EnumDevices") )
g_dnpt.loger.log(IDirectInputA.Hook("EnumDevices", "IDirectInputA_EnumDevices") )
g_dnpt.loger.log(IDirectInputW.Hook("EnumDevices", "IDirectInputW_EnumDevices") )
g_dnpt.loger.log(IDirectInputDevice2A.Hook("EnumEffects", "DInputEnumeffectsA"))
g_dnpt.loger.log(IDirectInputDevice2W.Hook("EnumEffects", "DInputEnumeffectsW"))
g_dnpt.loger.log(IDirectInputDevice8A.Hook("EnumEffects", "DInputEnumeffectsA"))
g_dnpt.loger.log(IDirectInputDevice8W.Hook("EnumEffects", "DInputEnumeffectsW"))
g_dnpt.loger.log(IDirectInputDevice2A.dllHook("CreateEffect", "DinputCreateEffectHook"))
g_dnpt.loger.log(IDirectInputDevice8A.dllHook("CreateEffect", "DinputCreateEffectHook"))
g_dnpt.loger.log(IDirectInputDevice2A.dllHook("GetEffectInfo", "DiGetEffectInfoA"))
g_dnpt.loger.log(IDirectInputDevice8A.dllHook("GetEffectInfo", "DiGetEffectInfoA"))
if (cfg.layer)
{
g_dnpt.loger.log(IDirectInputDevice2W.dllHook("CreateEffect", "DinputCreateEffectHook"))
g_dnpt.loger.log(IDirectInputDevice8W.dllHook("CreateEffect", "DinputCreateEffectHook"))
g_dnpt.loger.log(IDirectInputDevice2W.dllHook("GetEffectInfo", "DiGetEffectInfoW"))
g_dnpt.loger.log(IDirectInputDevice8W.dllHook("GetEffectInfo", "DiGetEffectInfoW"))
}
DINPT_HOOKS.CrtFx := IDirectInputDevice8A.CreateEffect
}
VarSetCapacity(zero, 32, 0)
g_dnpt.pz := &zero
return
}
DInputEnumeffectsA(p1, p2, p3, p4)
{
g_dnpt.loger.log("DInputEnumeffectsA")
return dllcall("peixoto.dll\DIEnumEffectsA", ptr, p2, ptr, p3, uint, p4)
}
DInputEnumeffectsW(p1, p2, p3, p4)
{
g_dnpt.loger.log("DInputEnumeffectsW")
return dllcall("peixoto.dll\DIEnumEffectsW", ptr, p2, ptr, p3, uint, p4)
}
IDirectInputDeviceA_SetProperty(p1, p2, p3)
{
r := dllcall(IDirectInputDeviceA.SetProperty, uint, p1, uint, p2, uint, p3)
logerr("IDirectInputDeviceA::SetProperty " r " " p2)
return 0
}
IDirectInputDeviceA_GetProperty(p1, p2, p3)
{
r := dllcall(IDirectInputDeviceA.GetProperty, uint, p1, uint, p2, uint, p3)
logerr("IDirectInputDeviceA::GetProperty " r " " p2)
return r
}
IDirectInputDeviceA_SetDataFormat(p1, p2)
{
r := dllcall(IDirectInputDeviceA.SetDataFormat, uint, p1, uint, p2)
logerr("IDirectInputDeviceA::SetDataFormat " r)
return r
}
IDirectInputDeviceA_SetCooperativeLevel(p1, p2, p3)
{
r := dllcall(IDirectInputDeviceA.SetCooperativeLevel, uint, p1, uint, p2, uint, p3)
logerr("IDirectInputDeviceA::SetCooperativeLevel " r)
return r
}
IDirectInputDeviceA_GetDeviceData(p1, p2, p3, p4, p5)
{
r := dllcall(IDirectInputDeviceA.GetDeviceData, uint, p1, uint, p2, uint, p3, uint, p4, uint, p5)
if (r)
{
logerr("IDirectInputDeviceA::GetDeviceData failed")
dllcall(IDirectInputDeviceA.Acquire, ptr, p1)
}
return 0
}
DiPatchCreateEffect(pDvc, caller)
{
dvc1          := new ComInterfaceWrapper(dinput.IDirectInputDeviceA, pDvc, True)
dvc1.released := True
GUID_FromString(GUID, dinput.IID_IDirectInputDevice2A)
q := dllcall(dvc1.QueryInterface, uint, dvc1.p, uint, &GUID, "uint*", d)
if (q = 0)
{
Dvc := new ComInterfaceWrapper(dinput.IDirectInputDevice2A, d, True)
logerr("IDirectInputDeviceA_Acquire: " Dvc.PatchVTableWithdll("CreateEffect", "DinputCreateEffectHook") )
}
}
IDirectInputDeviceA_Acquire(p1)
{
r := dllcall(IDirectInputDeviceA.Acquire, uint, p1)
if (r = 0)
{
}
return r
}
IDirectInputA_CreateDevice(p1, p2, p3, p4)
{
r := dllcall(IDirectInputA.CreateDevice, uint, p1, uint, p2, uint, p3, uint, p4)
if (r = 0)
{
DiPatchCreateEffect(numget(p3+0, ptr), "IDirectInputA::CreateDevice")
} return 0
}
IDirectInputDeviceA_GetCapabilities(p1, p2)
{
logerr(IDirectInputW.patchVtable("EnumDevices", "IDirectInputW_EnumDevices") )
if ! (r := dllcall(IDirectInputDeviceA.GetCapabilities, uint, p1, uint, p2))
{
DIDEVCAPS[] := p2
if (DIDEVCAPS.dwDevType & DIDEVTYPE_JOYSTICK)
{
if (DIDEVCAPS.dwSize = 44)
{
DIDEVCAPS.dwAxes    := 4
DIDEVCAPS.dwButtons := 12
if (DINPT_HOOKS.CrtFx)
DIDEVCAPS.dwFlags |= DIDC_FORCEFEEDBACK
}
else if (DIDEVCAPS.dwSize = 24)
{
DIDEVCAPS_DX3[]         := p2
DIDEVCAPS_DX3.dwAxes    := 4
DIDEVCAPS_DX3.dwButtons := 12
if (DINPT_HOOKS.CrtFx)
DIDEVCAPS_DX3.dwFlags |= DIDC_FORCEFEEDBACK
}
}
}
return r
}
IDirectInput8A_EnumDevices(p1, p2, p3, p4, p5)
{
g_dnpt.loger.log("IDirectInput8A_EnumDevices " p5&DIEDFL_FORCEFEEDBACK )
p5 &= ~ DIEDFL_FORCEFEEDBACK
return dllcall(IDirectInput8A.EnumDevices, uint, p1, uint, p2, uint, p3, uint, p4, uint, p5)
}
IDirectInput8W_EnumDevices(p1, p2, p3, p4, p5)
{
g_dnpt.loger.log("IDirectInput8W_EnumDevices " p5&DIEDFL_FORCEFEEDBACK )
p5 &= ~ DIEDFL_FORCEFEEDBACK
return dllcall(IDirectInput8W.EnumDevices, uint, p1, uint, p2, uint, p3, uint, p4, uint, p5)
}
IDirectInputA_EnumDevices(p1, p2, p3, p4, p5)
{
g_dnpt.loger.log("IDirectInputA_EnumDevices " p5&DIEDFL_FORCEFEEDBACK )
p5 &= ~ DIEDFL_FORCEFEEDBACK
return dllcall(IDirectInputA.EnumDevices, uint, p1, uint, p2, uint, p3, uint, p4, uint, p5)
}
IDirectInputW_EnumDevices(p1, p2, p3, p4, p5)
{
g_dnpt.loger.log("IDirectInputW_EnumDevices " p5&DIEDFL_FORCEFEEDBACK )
p5 &= ~ DIEDFL_FORCEFEEDBACK
return dllcall(IDirectInputW.EnumDevices, uint, p1, uint, p2, uint, p3, uint, p4, uint, p5)
}
(parsecfg(g_.cfg.J2K).u) ? InitDInputEmu(g_.cfg.J2K)
