;REMOTE SCRIPT START
g_.s.tx := {}
IDirect3DTexture.UnHook("Release")
logerr(IDirect3DTexture.hook("Release", "AltRelease"))
g_.s.release := RegisterCallback("IDirect3DTexture_Release", "F")

AltRelease(p1)
{
	if g_.s.tx[p1]
	return dllcall(g_.s.release, uint, p1)
	g_.s.tx[p1] := p1
	return
}

Alt_CreateSurface(pIDirectDraw, pSurfaceDesc, ppSurface, pIUnknown)
{
	DDSURFACEDESC[] := pSurfaceDesc
	caps  := DDSURFACEDESC.ddsCaps.dwCaps
	r := __IDirectDraw_CreateSurface(pIDirectDraw, pSurfaceDesc, ppSurface, pIUnknown, A_eventinfo)
	if (caps & DDSCAPS_PRIMARYSURFACE)
	{
		for k, v in g_.s.tx		
		{
			dllcall(g_.s.release, uint, v)
			g_.s.tx[k] := ""
		}
	}	
	return r 
}